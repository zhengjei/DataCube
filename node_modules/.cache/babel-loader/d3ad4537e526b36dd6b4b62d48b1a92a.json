{"remainingRequest":"F:\\DataCube\\node_modules\\babel-loader\\lib\\index.js!F:\\DataCube\\node_modules\\eslint-loader\\index.js??ref--13-0!F:\\DataCube\\src\\components\\ribbon.js","dependencies":[{"path":"F:\\DataCube\\src\\components\\ribbon.js","mtime":499162500000},{"path":"F:\\DataCube\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\DataCube\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"F:\\DataCube\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF90eXBlb2YgZnJvbSAiRjovRGF0YUN1YmUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3R5cGVvZiI7CmltcG9ydCBVdGlsIGZyb20gJy4vanMvdXRpbC5qcyc7CmltcG9ydCBTeXN0ZW1EZW1vIGZyb20gJy4vanMvc3lzdGVtZGVtby5qcyc7IC8v6L+Z5Liq5Ye95pWw5Zyo5pW05Liqd3Bz5Yqg6L296aG55Lit5piv56ys5LiA5Liq5omn6KGM55qECgpmdW5jdGlvbiBPbkFkZGluTG9hZChyaWJib25VSSkgewogIGlmIChfdHlwZW9mKHdwcy5yaWJib25VSSkgIT0gIm9iamVjdCIpIHsKICAgIHdwcy5yaWJib25VSSA9IHJpYmJvblVJOwogIH0KCiAgaWYgKF90eXBlb2Yod3BzLkVudW0pICE9ICJvYmplY3QiKSB7CiAgICAvLyDlpoLmnpzmsqHmnInlhoXnva7mnprkuL7lgLwKICAgIHdwcy5FbnVtID0gVXRpbC5XUFNfRW51bTsKICB9IC8v6L+Z5Yeg5Liq5a+85Ye65Ye95pWw5piv57uZ5aSW6YOo5Lia5Yqh57O757uf6LCD55So55qECgoKICB3aW5kb3cub3Blbk9mZmljZUZpbGVGcm9tU3lzdGVtRGVtbyA9IFN5c3RlbURlbW8ub3Blbk9mZmljZUZpbGVGcm9tU3lzdGVtRGVtbzsKICB3aW5kb3cuSW52b2tlRnJvbVN5c3RlbURlbW8gPSBTeXN0ZW1EZW1vLkludm9rZUZyb21TeXN0ZW1EZW1vOwogIHdwcy5QbHVnaW5TdG9yYWdlLnNldEl0ZW0oIkVuYWJsZUZsYWciLCBmYWxzZSk7IC8v5b6AUGx1Z2luU3RvcmFnZeS4reiuvue9ruS4gOS4quagh+iusO+8jOeUqOS6juaOp+WItuS4pOS4quaMiemSrueahOe9rueBsAoKICB3cHMuUGx1Z2luU3RvcmFnZS5zZXRJdGVtKCJBcGlFdmVudEZsYWciLCBmYWxzZSk7IC8v5b6AUGx1Z2luU3RvcmFnZeS4reiuvue9ruS4gOS4quagh+iusO+8jOeUqOS6juaOp+WItkFwaUV2ZW5055qE5oyJ6ZKubGFiZWwKCiAgcmV0dXJuIHRydWU7Cn0KCnZhciBXZWJOb3RpZnljb3VudCA9IDA7CgpmdW5jdGlvbiBPbkFjdGlvbihjb250cm9sKSB7CiAgdmFyIGVsZUlkID0gY29udHJvbC5JZDsKCiAgc3dpdGNoIChlbGVJZCkgewogICAgY2FzZSAiYnRuU2hvd01zZyI6CiAgICAgIHsKICAgICAgICB2YXIgZG9jID0gd3BzLkV0QXBwbGljYXRpb24oKS5BY3RpdmVXb3JrYm9vazsKCiAgICAgICAgaWYgKCFkb2MpIHsKICAgICAgICAgIGFsZXJ0KCLlvZPliY3msqHmnInmiZPlvIDku7vkvZXmlofmoaMiKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGFsZXJ0KGRvYy5OYW1lKTsKICAgICAgfQogICAgICBicmVhazsKCiAgICBjYXNlICJidG5Jc0VuYmFibGUiOgogICAgICB7CiAgICAgICAgdmFyIGJGbGFnID0gd3BzLlBsdWdpblN0b3JhZ2UuZ2V0SXRlbSgiRW5hYmxlRmxhZyIpOwogICAgICAgIHdwcy5QbHVnaW5TdG9yYWdlLnNldEl0ZW0oIkVuYWJsZUZsYWciLCAhYkZsYWcpOyAvL+mAmuefpXdwc+WIt+aWsOS7peS4i+WHoOS4quaMiemlsOeahOeKtuaAgQoKICAgICAgICB3cHMucmliYm9uVUkuSW52YWxpZGF0ZUNvbnRyb2woImJ0bklzRW5iYWJsZSIpOwogICAgICAgIHdwcy5yaWJib25VSS5JbnZhbGlkYXRlQ29udHJvbCgiYnRuU2hvd0RpYWxvZyIpOwogICAgICAgIHdwcy5yaWJib25VSS5JbnZhbGlkYXRlQ29udHJvbCgiYnRuU2hvd1Rhc2tQYW5lIik7IC8vd3BzLnJpYmJvblVJLkludmFsaWRhdGUoKTsg6L+Z6KGM5Luj56CB5omT5byA5YiZ5piv5Yi35paw5omA5pyJ55qE5oyJ6ZKu54q25oCBCgogICAgICAgIGJyZWFrOwogICAgICB9CgogICAgY2FzZSAiYnRuU2hvd0RpYWxvZyI6CiAgICAgIHdwcy5TaG93RGlhbG9nKFV0aWwuR2V0VXJsUGF0aCgpICsgImRpYWxvZyIsICLov5nmmK/kuIDkuKrlr7nor53moYbnvZHpobUiLCA0MDAgKiB3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbywgNDAwICogd2luZG93LmRldmljZVBpeGVsUmF0aW8sIGZhbHNlKTsKICAgICAgYnJlYWs7CgogICAgY2FzZSAiYnRuU2hvd1Rhc2tQYW5lIjoKICAgICAgewogICAgICAgIHZhciB0c0lkID0gd3BzLlBsdWdpblN0b3JhZ2UuZ2V0SXRlbSgidGFza3BhbmVfaWQiKTsKCiAgICAgICAgaWYgKCF0c0lkKSB7CiAgICAgICAgICB2YXIgdHNrcGFuZSA9IHdwcy5DcmVhdGVUYXNrUGFuZShVdGlsLkdldFVybFBhdGgoKSArICJ0YXNrcGFuZSIpOwogICAgICAgICAgdmFyIGlkID0gdHNrcGFuZS5JRDsKICAgICAgICAgIHdwcy5QbHVnaW5TdG9yYWdlLnNldEl0ZW0oInRhc2twYW5lX2lkIiwgaWQpOwogICAgICAgICAgdHNrcGFuZS5WaXNpYmxlID0gdHJ1ZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdmFyIF90c2twYW5lID0gd3BzLkdldFRhc2tQYW5lKHRzSWQpOwoKICAgICAgICAgIF90c2twYW5lLlZpc2libGUgPSAhX3Rza3BhbmUuVmlzaWJsZTsKICAgICAgICB9CiAgICAgIH0KICAgICAgYnJlYWs7CgogICAgY2FzZSAiYnRuQXBpRXZlbnQiOgogICAgICB7CiAgICAgICAgdmFyIF9iRmxhZyA9IHdwcy5QbHVnaW5TdG9yYWdlLmdldEl0ZW0oIkFwaUV2ZW50RmxhZyIpOwoKICAgICAgICB2YXIgYlJlZ2lzdGVyID0gX2JGbGFnID8gZmFsc2UgOiB0cnVlOwogICAgICAgIHdwcy5QbHVnaW5TdG9yYWdlLnNldEl0ZW0oIkFwaUV2ZW50RmxhZyIsIGJSZWdpc3Rlcik7CgogICAgICAgIGlmIChiUmVnaXN0ZXIpIHsKICAgICAgICAgIHdwcy5BcGlFdmVudC5BZGRBcGlFdmVudExpc3RlbmVyKCdOZXdXb3JrYm9vaycsICdyaWJib24uT25OZXdEb2N1bWVudEFwaUV2ZW50Jyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHdwcy5BcGlFdmVudC5SZW1vdmVBcGlFdmVudExpc3RlbmVyKCdOZXdXb3JrYm9vaycsICdyaWJib24uT25OZXdEb2N1bWVudEFwaUV2ZW50Jyk7CiAgICAgICAgfQoKICAgICAgICB3cHMucmliYm9uVUkuSW52YWxpZGF0ZUNvbnRyb2woImJ0bkFwaUV2ZW50Iik7CiAgICAgIH0KICAgICAgYnJlYWs7CgogICAgY2FzZSAiYnRuV2ViTm90aWZ5IjoKICAgICAgewogICAgICAgIHZhciBjdXJyZW50VGltZSA9IG5ldyBEYXRlKCk7CiAgICAgICAgdmFyIHRpbWVTdHIgPSBjdXJyZW50VGltZS5nZXRIb3VycygpICsgJzonICsgY3VycmVudFRpbWUuZ2V0TWludXRlcygpICsgIjoiICsgY3VycmVudFRpbWUuZ2V0U2Vjb25kcygpOwogICAgICAgIHdwcy5PQUFzc2lzdC5XZWJOb3RpZnkoIui/meihjOWGheWuueeUsXdwc+WKoOi9vemhueS4u+WKqOmAgei+vue7meS4muWKoeezu+e7n++8jOWPr+S7peS7u+aEj+iHquWumuS5iSwg5q+U5aaC5pe26Ze05YC8OiIgKyB0aW1lU3RyICsgIu+8jOasoeaVsO+8miIgKyArK1dlYk5vdGlmeWNvdW50LCB0cnVlKTsKICAgICAgfQogICAgICBicmVhazsKCiAgICBkZWZhdWx0OgogICAgICBicmVhazsKICB9CgogIHJldHVybiB0cnVlOwp9CgpmdW5jdGlvbiBHZXRJbWFnZShjb250cm9sKSB7CiAgdmFyIGVsZUlkID0gY29udHJvbC5JZDsKCiAgc3dpdGNoIChlbGVJZCkgewogICAgY2FzZSAiYnRuU2hvd01zZyI6CiAgICAgIHJldHVybiAiaW1hZ2VzLzEuc3ZnIjsKCiAgICBjYXNlICJidG5TaG93RGlhbG9nIjoKICAgICAgcmV0dXJuICJpbWFnZXMvMi5zdmciOwoKICAgIGNhc2UgImJ0blNob3dUYXNrUGFuZSI6CiAgICAgIHJldHVybiAiaW1hZ2VzLzMuc3ZnIjsKCiAgICBkZWZhdWx0OgogIH0KCiAgcmV0dXJuICJpbWFnZXMvbmV3RnJvbVRlbXAuc3ZnIjsKfQoKZnVuY3Rpb24gT25HZXRFbmFibGVkKGNvbnRyb2wpIHsKICB2YXIgZWxlSWQgPSBjb250cm9sLklkOwoKICBzd2l0Y2ggKGVsZUlkKSB7CiAgICBjYXNlICJidG5TaG93TXNnIjoKICAgICAgcmV0dXJuIHRydWU7CgogICAgY2FzZSAiYnRuU2hvd0RpYWxvZyI6CiAgICAgIHsKICAgICAgICB2YXIgYkZsYWcgPSB3cHMuUGx1Z2luU3RvcmFnZS5nZXRJdGVtKCJFbmFibGVGbGFnIik7CiAgICAgICAgcmV0dXJuIGJGbGFnOwogICAgICB9CgogICAgY2FzZSAiYnRuU2hvd1Rhc2tQYW5lIjoKICAgICAgewogICAgICAgIHZhciBfYkZsYWcyID0gd3BzLlBsdWdpblN0b3JhZ2UuZ2V0SXRlbSgiRW5hYmxlRmxhZyIpOwoKICAgICAgICByZXR1cm4gX2JGbGFnMjsKICAgICAgfQoKICAgIGRlZmF1bHQ6CiAgICAgIGJyZWFrOwogIH0KCiAgcmV0dXJuIHRydWU7Cn0KCmZ1bmN0aW9uIE9uR2V0VmlzaWJsZShjb250cm9sKSB7CiAgdmFyIGVsZUlkID0gY29udHJvbC5JZDsKICBjb25zb2xlLmxvZyhlbGVJZCk7CiAgcmV0dXJuIHRydWU7Cn0KCmZ1bmN0aW9uIE9uR2V0TGFiZWwoY29udHJvbCkgewogIHZhciBlbGVJZCA9IGNvbnRyb2wuSWQ7CgogIHN3aXRjaCAoZWxlSWQpIHsKICAgIGNhc2UgImJ0bklzRW5iYWJsZSI6CiAgICAgIHsKICAgICAgICB2YXIgYkZsYWcgPSB3cHMuUGx1Z2luU3RvcmFnZS5nZXRJdGVtKCJFbmFibGVGbGFnIik7CiAgICAgICAgcmV0dXJuIGJGbGFnID8gIuaMiemSrkRpc2FibGUiIDogIuaMiemSrkVuYWJsZSI7CiAgICAgIH0KCiAgICBjYXNlICJidG5BcGlFdmVudCI6CiAgICAgIHsKICAgICAgICB2YXIgX2JGbGFnMyA9IHdwcy5QbHVnaW5TdG9yYWdlLmdldEl0ZW0oIkFwaUV2ZW50RmxhZyIpOwoKICAgICAgICByZXR1cm4gX2JGbGFnMyA/ICLmuIXpmaTmlrDlu7rmlofku7bkuovku7YiIDogIuazqOWGjOaWsOW7uuaWh+S7tuS6i+S7tiI7CiAgICAgIH0KICB9CgogIHJldHVybiAiIjsKfQoKZnVuY3Rpb24gT25OZXdEb2N1bWVudEFwaUV2ZW50KGRvYykgewogIGFsZXJ0KCLmlrDlu7rmlofku7bkuovku7blk43lupTvvIzlj5bmlofku7blkI06ICIgKyBkb2MuTmFtZSk7Cn0gLy/ov5nkupvlh73mlbDmmK/nu5l3cHPlrqLmiLfnq6/osIPnlKjnmoQKCgpleHBvcnQgZGVmYXVsdCB7CiAgT25BZGRpbkxvYWQ6IE9uQWRkaW5Mb2FkLAogIE9uQWN0aW9uOiBPbkFjdGlvbiwKICBHZXRJbWFnZTogR2V0SW1hZ2UsCiAgT25HZXRFbmFibGVkOiBPbkdldEVuYWJsZWQsCiAgT25HZXRWaXNpYmxlOiBPbkdldFZpc2libGUsCiAgT25HZXRMYWJlbDogT25HZXRMYWJlbCwKICBPbk5ld0RvY3VtZW50QXBpRXZlbnQ6IE9uTmV3RG9jdW1lbnRBcGlFdmVudAp9Ow=="},{"version":3,"sources":["F:/DataCube/src/components/ribbon.js"],"names":["Util","SystemDemo","OnAddinLoad","ribbonUI","wps","Enum","WPS_Enum","window","openOfficeFileFromSystemDemo","InvokeFromSystemDemo","PluginStorage","setItem","WebNotifycount","OnAction","control","eleId","Id","doc","EtApplication","ActiveWorkbook","alert","Name","bFlag","getItem","InvalidateControl","ShowDialog","GetUrlPath","devicePixelRatio","tsId","tskpane","CreateTaskPane","id","ID","Visible","GetTaskPane","bRegister","ApiEvent","AddApiEventListener","RemoveApiEventListener","currentTime","Date","timeStr","getHours","getMinutes","getSeconds","OAAssist","WebNotify","GetImage","OnGetEnabled","OnGetVisible","console","log","OnGetLabel","OnNewDocumentApiEvent"],"mappings":"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","sourcesContent":["import Util from './js/util.js'\nimport SystemDemo from './js/systemdemo.js'\n\n//这个函数在整个wps加载项中是第一个执行的\nfunction OnAddinLoad(ribbonUI){\n    if (typeof (wps.ribbonUI) != \"object\"){\n\t\twps.ribbonUI = ribbonUI\n    }\n    \n    if (typeof (wps.Enum) != \"object\") { // 如果没有内置枚举值\n        wps.Enum = Util.WPS_Enum\n    }\n\n    //这几个导出函数是给外部业务系统调用的\n    window.openOfficeFileFromSystemDemo = SystemDemo.openOfficeFileFromSystemDemo\n    window.InvokeFromSystemDemo = SystemDemo.InvokeFromSystemDemo\n\n    wps.PluginStorage.setItem(\"EnableFlag\", false) //往PluginStorage中设置一个标记，用于控制两个按钮的置灰\n    wps.PluginStorage.setItem(\"ApiEventFlag\", false) //往PluginStorage中设置一个标记，用于控制ApiEvent的按钮label\n    return true\n}\n\nvar WebNotifycount = 0;\nfunction OnAction(control) {\n    const eleId = control.Id\n    switch (eleId) {\n        case \"btnShowMsg\":\n            {\n                const doc = wps.EtApplication().ActiveWorkbook\n                if (!doc) {\n                    alert(\"当前没有打开任何文档\")\n                    return\n                }\n                alert(doc.Name)\n            }\n            break;\n        case \"btnIsEnbable\":\n            {\n                let bFlag = wps.PluginStorage.getItem(\"EnableFlag\")\n                wps.PluginStorage.setItem(\"EnableFlag\", !bFlag)\n                \n                //通知wps刷新以下几个按饰的状态\n                wps.ribbonUI.InvalidateControl(\"btnIsEnbable\")\n                wps.ribbonUI.InvalidateControl(\"btnShowDialog\") \n                wps.ribbonUI.InvalidateControl(\"btnShowTaskPane\") \n                //wps.ribbonUI.Invalidate(); 这行代码打开则是刷新所有的按钮状态\n                break\n            }\n        case \"btnShowDialog\":\n            wps.ShowDialog(Util.GetUrlPath() + \"dialog\", \"这是一个对话框网页\", 400 * window.devicePixelRatio, 400 * window.devicePixelRatio, false)\n            break\n        case \"btnShowTaskPane\":\n            {\n                let tsId = wps.PluginStorage.getItem(\"taskpane_id\")\n                if (!tsId) {\n                    let tskpane = wps.CreateTaskPane(Util.GetUrlPath() + \"taskpane\")\n                    let id = tskpane.ID\n                    wps.PluginStorage.setItem(\"taskpane_id\", id)\n                    tskpane.Visible = true\n                } else {\n                    let tskpane = wps.GetTaskPane(tsId)\n                    tskpane.Visible = !tskpane.Visible\n                }\n            }\n            break\n        case \"btnApiEvent\":\n            {\n                let bFlag = wps.PluginStorage.getItem(\"ApiEventFlag\")\n                let bRegister = bFlag ? false : true\n                wps.PluginStorage.setItem(\"ApiEventFlag\", bRegister)\n                if (bRegister){\n                    wps.ApiEvent.AddApiEventListener('NewWorkbook', 'ribbon.OnNewDocumentApiEvent')\n                }\n                else{\n                    wps.ApiEvent.RemoveApiEventListener('NewWorkbook', 'ribbon.OnNewDocumentApiEvent')\n                }\n                \n                wps.ribbonUI.InvalidateControl(\"btnApiEvent\") \n            }\n            break\n        case \"btnWebNotify\":\n            {\n                let currentTime = new Date()\n                let timeStr = currentTime.getHours() + ':' + currentTime.getMinutes() + \":\" + currentTime.getSeconds()\n                wps.OAAssist.WebNotify(\"这行内容由wps加载项主动送达给业务系统，可以任意自定义, 比如时间值:\" + timeStr + \"，次数：\" + (++WebNotifycount), true)\n            }\n            break\n        default:\n            break\n    }\n    return true\n}\n\nfunction GetImage(control) {\n    const eleId = control.Id\n    switch (eleId) {\n        case \"btnShowMsg\":\n            return \"images/1.svg\"\n        case \"btnShowDialog\":\n            return \"images/2.svg\"\n        case \"btnShowTaskPane\":\n            return \"images/3.svg\"\n        default:\n    }\n    return \"images/newFromTemp.svg\"\n}\n\nfunction OnGetEnabled(control) {\n    const eleId = control.Id\n    switch (eleId) {\n        case \"btnShowMsg\":\n            return true\n        case \"btnShowDialog\":\n            {\n                let bFlag = wps.PluginStorage.getItem(\"EnableFlag\")\n                return bFlag\n            }\n        case \"btnShowTaskPane\":\n            {\n                let bFlag = wps.PluginStorage.getItem(\"EnableFlag\")\n                return bFlag\n            }\n        default:\n            break\n    }\n    return true\n}\n\nfunction OnGetVisible(control){\n    const eleId = control.Id\n    console.log(eleId)\n    return true\n}\n\nfunction OnGetLabel(control){\n    const eleId = control.Id\n    switch (eleId) {\n        case \"btnIsEnbable\":\n            {\n                let bFlag = wps.PluginStorage.getItem(\"EnableFlag\")\n                return bFlag ?  \"按钮Disable\" : \"按钮Enable\"\n            }\n        case \"btnApiEvent\":\n            {\n                let bFlag = wps.PluginStorage.getItem(\"ApiEventFlag\")\n                return bFlag ? \"清除新建文件事件\" : \"注册新建文件事件\"\n            }    \n    }\n    return \"\"\n}\n\nfunction OnNewDocumentApiEvent(doc){\n    alert(\"新建文件事件响应，取文件名: \" + doc.Name)\n}\n\n//这些函数是给wps客户端调用的\nexport default {\n    OnAddinLoad,\n    OnAction,\n    GetImage,\n    OnGetEnabled,\n    OnGetVisible,\n    OnGetLabel,\n    OnNewDocumentApiEvent\n};\n"]}]}