{"remainingRequest":"E:\\tmp\\BossWps\\node_modules\\babel-loader\\lib\\index.js!E:\\tmp\\BossWps\\node_modules\\eslint-loader\\index.js??ref--13-0!E:\\tmp\\BossWps\\src\\components\\js\\taskpane.js","dependencies":[{"path":"E:\\tmp\\BossWps\\src\\components\\js\\taskpane.js","mtime":499162500000},{"path":"E:\\tmp\\BossWps\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\tmp\\BossWps\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"E:\\tmp\\BossWps\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF90eXBlb2YgZnJvbSAiRTovdG1wL0Jvc3NXcHMvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3R5cGVvZiI7CmltcG9ydCBVdGlsIGZyb20gIi4vdXRpbC5qcyI7CgpmdW5jdGlvbiBvbmJ1dHRvbmNsaWNrKGlkU3RyLCBwYXJhbSkgewogIGlmIChfdHlwZW9mKHdwcy5FbnVtKSAhPSAib2JqZWN0IikgewogICAgLy8g5aaC5p6c5rKh5pyJ5YaF572u5p6a5Li+5YC8CiAgICB3cHMuRW51bSA9IFV0aWwuV1BTX0VudW07CiAgfQoKICBzd2l0Y2ggKGlkU3RyKSB7CiAgICBjYXNlICJkb2NrTGVmdCI6CiAgICAgIHsKICAgICAgICB2YXIgdHNJZCA9IHdwcy5QbHVnaW5TdG9yYWdlLmdldEl0ZW0oInRhc2twYW5lX2lkIik7CgogICAgICAgIGlmICh0c0lkKSB7CiAgICAgICAgICB2YXIgdHNrcGFuZSA9IHdwcy5HZXRUYXNrUGFuZSh0c0lkKTsKICAgICAgICAgIHRza3BhbmUuRG9ja1Bvc2l0aW9uID0gd3BzLkVudW0ubXNvQ1RQRG9ja1Bvc2l0aW9uTGVmdDsKICAgICAgICB9CgogICAgICAgIGJyZWFrOwogICAgICB9CgogICAgY2FzZSAiZG9ja1JpZ2h0IjoKICAgICAgewogICAgICAgIHZhciBfdHNJZCA9IHdwcy5QbHVnaW5TdG9yYWdlLmdldEl0ZW0oInRhc2twYW5lX2lkIik7CgogICAgICAgIGlmIChfdHNJZCkgewogICAgICAgICAgdmFyIF90c2twYW5lID0gd3BzLkdldFRhc2tQYW5lKF90c0lkKTsKCiAgICAgICAgICBfdHNrcGFuZS5Eb2NrUG9zaXRpb24gPSB3cHMuRW51bS5tc29DVFBEb2NrUG9zaXRpb25SaWdodDsKICAgICAgICB9CgogICAgICAgIGJyZWFrOwogICAgICB9CgogICAgY2FzZSAiaGlkZVRhc2tQYW5lIjoKICAgICAgewogICAgICAgIHZhciBfdHNJZDIgPSB3cHMuUGx1Z2luU3RvcmFnZS5nZXRJdGVtKCJ0YXNrcGFuZV9pZCIpOwoKICAgICAgICBpZiAoX3RzSWQyKSB7CiAgICAgICAgICB2YXIgX3Rza3BhbmUyID0gd3BzLkdldFRhc2tQYW5lKF90c0lkMik7CgogICAgICAgICAgX3Rza3BhbmUyLlZpc2libGUgPSBmYWxzZTsKICAgICAgICB9CgogICAgICAgIGJyZWFrOwogICAgICB9CgogICAgY2FzZSAiYWRkU3RyaW5nIjoKICAgICAgewogICAgICAgIHZhciBjdXJTaGVldCA9IHdwcy5FdEFwcGxpY2F0aW9uKCkuQWN0aXZlU2hlZXQ7CgogICAgICAgIGlmIChjdXJTaGVldCkgewogICAgICAgICAgY3VyU2hlZXQuQ2VsbHMuSXRlbSgxLCAxKS5Gb3JtdWxhID0gIkhlbGxvLCB3cHPliqDovb3pobkhIiArIGN1clNoZWV0LkNlbGxzLkl0ZW0oMSwgMSkuRm9ybXVsYTsKICAgICAgICB9CgogICAgICAgIGJyZWFrOwogICAgICB9CgogICAgY2FzZSAiZ2V0RG9jTmFtZSI6CiAgICAgIHsKICAgICAgICB2YXIgZG9jID0gd3BzLkV0QXBwbGljYXRpb24oKS5BY3RpdmVXb3JrYm9vazsKCiAgICAgICAgaWYgKCFkb2MpIHsKICAgICAgICAgIHJldHVybiAi5b2T5YmN5rKh5pyJ5omT5byA5Lu75L2V5paH5qGjIjsKICAgICAgICB9CgogICAgICAgIHJldHVybiBkb2MuTmFtZTsKICAgICAgfQoKICAgIGNhc2UgIm9wZW5XZWIiOgogICAgICB7CiAgICAgICAgd3BzLk9BQXNzaXN0LlNoZWxsRXhlY3V0ZShwYXJhbSk7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICB9Cn0KCmV4cG9ydCBkZWZhdWx0IHsKICBvbmJ1dHRvbmNsaWNrOiBvbmJ1dHRvbmNsaWNrCn07"},{"version":3,"sources":["E:/tmp/BossWps/src/components/js/taskpane.js"],"names":["Util","onbuttonclick","idStr","param","wps","Enum","WPS_Enum","tsId","PluginStorage","getItem","tskpane","GetTaskPane","DockPosition","msoCTPDockPositionLeft","msoCTPDockPositionRight","Visible","curSheet","EtApplication","ActiveSheet","Cells","Item","Formula","doc","ActiveWorkbook","Name","OAAssist","ShellExecute"],"mappings":";AAAA,OAAOA,IAAP,MAAiB,WAAjB;;AAEA,SAASC,aAAT,CAAuBC,KAAvB,EAA8BC,KAA9B,EACA;AACI,MAAI,QAAQC,GAAG,CAACC,IAAZ,KAAqB,QAAzB,EAAmC;AAAE;AACjCD,IAAAA,GAAG,CAACC,IAAJ,GAAWL,IAAI,CAACM,QAAhB;AACH;;AACD,UAAOJ,KAAP;AAEI,SAAK,UAAL;AAAgB;AACZ,YAAIK,IAAI,GAAGH,GAAG,CAACI,aAAJ,CAAkBC,OAAlB,CAA0B,aAA1B,CAAX;;AACA,YAAIF,IAAJ,EAAS;AACL,cAAIG,OAAO,GAAGN,GAAG,CAACO,WAAJ,CAAgBJ,IAAhB,CAAd;AACAG,UAAAA,OAAO,CAACE,YAAR,GAAuBR,GAAG,CAACC,IAAJ,CAASQ,sBAAhC;AACH;;AACD;AACC;;AACL,SAAK,WAAL;AAAiB;AACb,YAAIN,KAAI,GAAGH,GAAG,CAACI,aAAJ,CAAkBC,OAAlB,CAA0B,aAA1B,CAAX;;AACA,YAAIF,KAAJ,EAAS;AACL,cAAIG,QAAO,GAAGN,GAAG,CAACO,WAAJ,CAAgBJ,KAAhB,CAAd;;AACAG,UAAAA,QAAO,CAACE,YAAR,GAAuBR,GAAG,CAACC,IAAJ,CAASS,uBAAhC;AACH;;AACD;AACH;;AACD,SAAK,cAAL;AAAoB;AAChB,YAAIP,MAAI,GAAGH,GAAG,CAACI,aAAJ,CAAkBC,OAAlB,CAA0B,aAA1B,CAAX;;AACA,YAAIF,MAAJ,EAAS;AACL,cAAIG,SAAO,GAAGN,GAAG,CAACO,WAAJ,CAAgBJ,MAAhB,CAAd;;AACAG,UAAAA,SAAO,CAACK,OAAR,GAAkB,KAAlB;AACH;;AACD;AACH;;AACD,SAAK,WAAL;AAAiB;AACb,YAAIC,QAAQ,GAAGZ,GAAG,CAACa,aAAJ,GAAoBC,WAAnC;;AACA,YAAIF,QAAJ,EAAa;AACTA,UAAAA,QAAQ,CAACG,KAAT,CAAeC,IAAf,CAAoB,CAApB,EAAuB,CAAvB,EAA0BC,OAA1B,GAAkC,mBAAmBL,QAAQ,CAACG,KAAT,CAAeC,IAAf,CAAoB,CAApB,EAAuB,CAAvB,EAA0BC,OAA/E;AACH;;AACD;AACH;;AACD,SAAK,YAAL;AAAkB;AACd,YAAIC,GAAG,GAAGlB,GAAG,CAACa,aAAJ,GAAoBM,cAA9B;;AACA,YAAI,CAACD,GAAL,EAAS;AACL,iBAAO,YAAP;AACH;;AACD,eAAOA,GAAG,CAACE,IAAX;AACH;;AACD,SAAK,SAAL;AAAgB;AACZpB,QAAAA,GAAG,CAACqB,QAAJ,CAAaC,YAAb,CAA0BvB,KAA1B;AACA;AACH;AA3CL;AA6CH;;AAED,eAAc;AACVF,EAAAA,aAAa,EAAbA;AADU,CAAd","sourcesContent":["import Util from \"./util.js\"\r\n\r\nfunction onbuttonclick(idStr, param)\r\n{\r\n    if (typeof (wps.Enum) != \"object\") { // 如果没有内置枚举值\r\n        wps.Enum = Util.WPS_Enum\r\n    }\r\n    switch(idStr)\r\n    {\r\n        case \"dockLeft\":{\r\n            let tsId = wps.PluginStorage.getItem(\"taskpane_id\")\r\n            if (tsId){\r\n                let tskpane = wps.GetTaskPane(tsId)\r\n                tskpane.DockPosition = wps.Enum.msoCTPDockPositionLeft\r\n            }\r\n            break\r\n            }\r\n        case \"dockRight\":{\r\n            let tsId = wps.PluginStorage.getItem(\"taskpane_id\")\r\n            if (tsId){\r\n                let tskpane = wps.GetTaskPane(tsId)\r\n                tskpane.DockPosition = wps.Enum.msoCTPDockPositionRight\r\n            }\r\n            break\r\n        }\r\n        case \"hideTaskPane\":{\r\n            let tsId = wps.PluginStorage.getItem(\"taskpane_id\")\r\n            if (tsId){\r\n                let tskpane = wps.GetTaskPane(tsId)\r\n                tskpane.Visible = false\r\n            }\r\n            break\r\n        }\r\n        case \"addString\":{\r\n            let curSheet = wps.EtApplication().ActiveSheet;\r\n            if (curSheet){\r\n                curSheet.Cells.Item(1, 1).Formula=\"Hello, wps加载项!\" + curSheet.Cells.Item(1, 1).Formula\r\n            }\r\n            break;\r\n        }\r\n        case \"getDocName\":{\r\n            let doc = wps.EtApplication().ActiveWorkbook\r\n            if (!doc){\r\n                return \"当前没有打开任何文档\"\r\n            }\r\n            return doc.Name\r\n        }\r\n        case \"openWeb\": {\r\n            wps.OAAssist.ShellExecute(param)\r\n            break\r\n        }\r\n    }\r\n}\r\n\r\nexport default{\r\n    onbuttonclick\r\n}"]}]}